<!DOCTYPE html>
<head lang="en">
    <title>Ball game</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <style>
        canvas, button, div{
            margin:auto;
            display: block;
            text-align: center;
        }
    </style>
</head>
<body onload="init();">
    <canvas id="myCanvas" width="500" height="350" border="" style="border:solid"></canvas>
    <div id="hello"></div>
    <div id="world"></div>
    <button id="btn" onClick="history.go(0)" >Restart</button>
    <script>
        var context;
        var x=200;
        var y=200;
        var dx=-5;
        var dy=-5;
        var a=150;
        var da=30;
        var brick = [75,25];
        var offset = [[100,100],[175,125],[250,100],[175,75],[325,125],[325,75]];
        

        function init()
        {
            context= myCanvas.getContext('2d');
            var startDraw = setInterval(draw,10);
            function draw()
            {
                if (y > 400 || offset.length == 0) {
                clearInterval(startDraw);
                }
                else{
                    //drawing a circle
                    context.clearRect(0,0, 500,350);
                    context.beginPath();
                    context.moveTo(a,300);
                    context.lineTo(a+150, 300);
                    context.stroke();
                    
                    //draw
                    context.beginPath();
                    context.arc(x,y,10,0,Math.PI*2,true);
                    context.closePath();
                    context.stroke();

                    //canvas margin conditions
                    document.getElementById("hello").innerHTML = "pos x: "+x+" pos a: "+a+" number of bricks: "+offset.length;
                    if( x<0 || x>500) dx=-dx; 
                    if( y<0 || y>350) dy=-dy;

                    //reflector margin conditions
                    if( y==300 && x>=a && x<=a+150 )dy=-dy;
                    x+=dx;
                    y+=dy;

                    //brick handling
                    for(i=0; i<offset.length; i++){
                            //brick margin condition
                            if( x>offset[i][0] && x<brick[0]+offset[i][0] && y==offset[i][1] ) {dy=-dy; offset.splice(i, 1);} ;
                            if( x>offset[i][0] && x<brick[0]+offset[i][0] && y==offset[i][1]+brick[1] ) {dy=-dy; offset.splice(i, 1);};
                            if( x==offset[i][0] && y>offset[i][1] && y<offset[i][1]+brick[1]) {dx=-dx; offset.splice(i, 1);};
                            if( x==offset[i][0]+brick[0] && y>offset[i][1] && y<offset[i][1]+brick[1] ) {dx=-dx; offset.splice(i, 1);};
                            //draw brick
                            context.fillStyle="#ff0000";
                            context.rect(offset[i][0],offset[i][1],brick[0],brick[1]);
                            context.stroke();
                            context.closePath();
                            context.fill();
                    };
                };
            };
        };

        document.onkeydown = function(e) {
                switch (e.keyCode) {
                case 37:
                a = a - da;
                break;
                case 39:
                a = a + da;
                break;
            }
        };
    </script>
</body>
